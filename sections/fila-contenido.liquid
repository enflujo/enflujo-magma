{% comment %}
  Sección de fila flexible: permite agregar bloques de texto o imagen
  con control de ancho individual (1, 1/2, 1/3, 1/4) que se muestran en línea.
{% endcomment %}

<div class='filaContenido filaContenido--{{ section.settings.alineacion_elementos | default: 'start' }}'>
  {% for block in section.blocks %}
    {% assign ancho = block.settings.ancho | default: 'completo' %}
    {% assign alineacion = block.settings.alineacion | default: 'centro' %}
    {% assign alineacion_vertical = block.settings.alineacion_vertical | default: 'arriba' %}
    {% assign espaciado_parrafos = block.settings.espaciado_parrafos | default: 1 %}
    {% assign line_height = block.settings.line_height | default: 1.5 %}
    <div
      class='bloqueContenido bloqueContenido--{{ ancho }} bloqueContenido--{{ alineacion }} bloqueContenido--v-{{ alineacion_vertical }}'
      style='--espaciado-p: {{ espaciado_parrafos }}em; --line-height: {{ line_height }};'
      {{ block.shopify_attributes }}
    >
      {% case block.type %}
        {% when 'texto' %}
          {% assign borde_posicion = block.settings.borde_posicion | default: 'ninguno' %}
          {% assign borde_grosor = block.settings.borde_grosor | default: 1 %}
          <div class='contenidoTexto contenidoTexto--borde-{{ borde_posicion }}' style='--borde-grosor: {{ borde_grosor }}px;'>
            {{ block.settings.texto }}
            {% if block.settings.enlace_boton != blank %}
              <div class='enlaceTexto botonDestacado botonDestacado--{{ block.settings.estilo_boton | default: 'claro' }} alinear-{{ block.settings.alineacion | default: 'centro' }}'>
                <a href='{{ block.settings.enlace_boton }}'>
                  {{ block.settings.texto_boton | default: 'Ver más' }}
                </a>
              </div>
            {% endif %}
          </div>
        {% when 'imagen' %}
          {% if block.settings.sticky %}
            <div class='contenidoImagen contenidoImagen--flotante contenidoImagen--flotante-{{ block.settings.posicion_sticky | default: 'derecha' }}'>
              {% if block.settings.imagen != blank %}
                {% render 'imagen', image: block.settings.imagen, width: 400, class: 'imagenBloque' %}
                {% if block.settings.leyenda != blank %}
                  <p class='leyendaImagen'>{{ block.settings.leyenda }}</p>
                {% endif %}
              {% endif %}
            </div>
          {% else %}
            <div class='contenidoImagen'>
              {% if block.settings.imagen != blank %}
                {% render 'imagen', image: block.settings.imagen, width: 800, class: 'imagenBloque' %}
                {% if block.settings.leyenda != blank %}
                  <p class='leyendaImagen'>{{ block.settings.leyenda }}</p>
                {% endif %}
              {% endif %}
            </div>
          {% endif %}
        {% when 'acordeon' %}
          <div class='contenidoAcordeon'>
            {% if block.settings.titulo_acordeon != blank %}
              {% render 'acordeon', title: block.settings.titulo_acordeon, content: block.settings.contenido_acordeon %}
            {% endif %}
          </div>
      {% endcase %}
    </div>
  {% endfor %}
</div>

{% schema %}
{
  "name": "Fila de contenido",
  "settings": [
    {
      "type": "select",
      "id": "alineacion_elementos",
      "label": "Alineación de elementos",
      "default": "start",
      "info": "Controla cómo se distribuyen los bloques horizontalmente",
      "options": [
        { "value": "start", "label": "Inicio" },
        { "value": "center", "label": "Centro" },
        { "value": "end", "label": "Final" },
        { "value": "space-between", "label": "Espacio entre elementos" },
        { "value": "space-around", "label": "Espacio alrededor" },
        { "value": "space-evenly", "label": "Espacio uniforme" }
      ]
    }
  ],
  "blocks": [
    {
      "type": "texto",
      "name": "Texto",
      "settings": [
        {
          "type": "select",
          "id": "ancho",
          "label": "Ancho del bloque",
          "options": [
            {
              "value": "completo",
              "label": "Completo (1)"
            },
            {
              "value": "mitad",
              "label": "Mitad (1/2)"
            },
            {
              "value": "tercio",
              "label": "Tercio (1/3)"
            },
            {
              "value": "dos-tercios",
              "label": "Dos tercios (2/3)"
            },
            {
              "value": "cuarto",
              "label": "Cuarto (1/4)"
            },
            {
              "value": "tres-cuartos",
              "label": "Tres cuartos (3/4)"
            },
            {
              "value": "quinto",
              "label": "Quinto (1/5)"
            },
            {
              "value": "dos-quintos",
              "label": "Dos quintos (2/5)"
            },
            {
              "value": "tres-quintos",
              "label": "Tres quintos (3/5)"
            },
            {
              "value": "cuatro-quintos",
              "label": "Cuatro quintos (4/5)"
            }
          ],
          "default": "mitad",
          "info": "Ancho del bloque. Varios bloques se mostrarán en línea según su ancho."
        },
        {
          "type": "select",
          "id": "alineacion",
          "label": "Alineación",
          "options": [
            {
              "value": "izquierda",
              "label": "Izquierda"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "derecha",
              "label": "Derecha"
            }
          ],
          "default": "centro",
          "info": "Alineación horizontal del contenido dentro del bloque."
        },
        {
          "type": "select",
          "id": "alineacion_vertical",
          "label": "Alineación vertical",
          "options": [
            {
              "value": "arriba",
              "label": "Arriba"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "abajo",
              "label": "Abajo"
            }
          ],
          "default": "arriba",
          "info": "Alineación vertical cuando los bloques tienen diferentes alturas."
        },
        {
          "type": "range",
          "id": "espaciado_parrafos",
          "label": "Espaciado entre párrafos",
          "min": 0,
          "max": 3,
          "step": 0.5,
          "unit": "em",
          "default": 1,
          "info": "Espacio vertical entre párrafos."
        },
        {
          "type": "range",
          "id": "line_height",
          "label": "Altura de línea",
          "min": 1,
          "max": 2.5,
          "step": 0.1,
          "default": 1.5,
          "info": "Espaciado entre líneas de texto."
        },
        {
          "type": "richtext",
          "id": "texto",
          "label": "Texto"
        },
        {
          "type": "text",
          "id": "texto_boton",
          "label": "Texto del botón (opcional)"
        },
        {
          "type": "url",
          "id": "enlace_boton",
          "label": "Enlace del botón"
        },
        {
          "type": "select",
          "id": "estilo_boton",
          "label": "Estilo del botón",
          "default": "claro",
          "options": [
            { "value": "claro", "label": "Fondo claro, texto negro" },
            { "value": "oscuro", "label": "Fondo negro, texto blanco" }
          ]
        },
        {
          "type": "select",
          "id": "borde_posicion",
          "label": "Posición del borde",
          "default": "ninguno",
          "options": [
            { "value": "ninguno", "label": "Sin borde" },
            { "value": "arriba", "label": "Arriba" },
            { "value": "abajo", "label": "Abajo" },
            { "value": "izquierda", "label": "Izquierda" },
            { "value": "derecha", "label": "Derecha" },
            { "value": "completo", "label": "Completo" }
          ]
        },
        {
          "type": "range",
          "id": "borde_grosor",
          "label": "Grosor del borde",
          "min": 1,
          "max": 5,
          "step": 1,
          "unit": "px",
          "default": 1
        }
      ]
    },
    {
      "type": "imagen",
      "name": "Imagen",
      "settings": [
        {
          "type": "select",
          "id": "ancho",
          "label": "Ancho del bloque",
          "options": [
            {
              "value": "completo",
              "label": "Completo (1)"
            },
            {
              "value": "mitad",
              "label": "Mitad (1/2)"
            },
            {
              "value": "tercio",
              "label": "Tercio (1/3)"
            },
            {
              "value": "dos-tercios",
              "label": "Dos tercios (2/3)"
            },
            {
              "value": "cuarto",
              "label": "Cuarto (1/4)"
            },
            {
              "value": "tres-cuartos",
              "label": "Tres cuartos (3/4)"
            },
            {
              "value": "quinto",
              "label": "Quinto (1/5)"
            },
            {
              "value": "dos-quintos",
              "label": "Dos quintos (2/5)"
            },
            {
              "value": "tres-quintos",
              "label": "Tres quintos (3/5)"
            },
            {
              "value": "cuatro-quintos",
              "label": "Cuatro quintos (4/5)"
            }
          ],
          "default": "mitad",
          "info": "Ancho del bloque. Varios bloques se mostrarán en línea según su ancho."
        },
        {
          "type": "select",
          "id": "alineacion",
          "label": "Alineación",
          "options": [
            {
              "value": "izquierda",
              "label": "Izquierda"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "derecha",
              "label": "Derecha"
            }
          ],
          "default": "centro",
          "info": "Alineación horizontal del contenido dentro del bloque."
        },
        {
          "type": "select",
          "id": "alineacion_vertical",
          "label": "Alineación vertical",
          "options": [
            {
              "value": "arriba",
              "label": "Arriba"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "abajo",
              "label": "Abajo"
            }
          ],
          "default": "arriba",
          "info": "Alineación vertical cuando los bloques tienen diferentes alturas."
        },
        {
          "type": "image_picker",
          "id": "imagen",
          "label": "Imagen"
        },
        {
          "type": "text",
          "id": "leyenda",
          "label": "Leyenda (opcional)"
        },
        {
          "type": "checkbox",
          "id": "sticky",
          "label": "Imagen flotante",
          "default": false,
          "info": "La imagen flotará sobre el contenido sin ocupar espacio en el flujo"
        },
        {
          "type": "select",
          "id": "posicion_sticky",
          "label": "Posición de imagen flotante",
          "default": "derecha",
          "options": [
            { "value": "izquierda", "label": "Izquierda" },
            { "value": "derecha", "label": "Derecha" }
          ],
          "info": "Solo aplica si 'Imagen flotante' está activado"
        }
      ]
    },
    {
      "type": "acordeon",
      "name": "Acordeón",
      "settings": [
        {
          "type": "select",
          "id": "ancho",
          "label": "Ancho del bloque",
          "options": [
            {
              "value": "completo",
              "label": "Completo (1)"
            },
            {
              "value": "mitad",
              "label": "Mitad (1/2)"
            },
            {
              "value": "tercio",
              "label": "Tercio (1/3)"
            },
            {
              "value": "dos-tercios",
              "label": "Dos tercios (2/3)"
            },
            {
              "value": "cuarto",
              "label": "Cuarto (1/4)"
            },
            {
              "value": "tres-cuartos",
              "label": "Tres cuartos (3/4)"
            },
            {
              "value": "quinto",
              "label": "Quinto (1/5)"
            },
            {
              "value": "dos-quintos",
              "label": "Dos quintos (2/5)"
            },
            {
              "value": "tres-quintos",
              "label": "Tres quintos (3/5)"
            },
            {
              "value": "cuatro-quintos",
              "label": "Cuatro quintos (4/5)"
            }
          ],
          "default": "completo",
          "info": "Ancho del bloque. Varios bloques se mostrarán en línea según su ancho."
        },
        {
          "type": "select",
          "id": "alineacion",
          "label": "Alineación",
          "options": [
            {
              "value": "izquierda",
              "label": "Izquierda"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "derecha",
              "label": "Derecha"
            }
          ],
          "default": "izquierda",
          "info": "Alineación horizontal del contenido dentro del bloque."
        },
        {
          "type": "select",
          "id": "alineacion_vertical",
          "label": "Alineación vertical",
          "options": [
            {
              "value": "arriba",
              "label": "Arriba"
            },
            {
              "value": "centro",
              "label": "Centro"
            },
            {
              "value": "abajo",
              "label": "Abajo"
            }
          ],
          "default": "arriba",
          "info": "Alineación vertical cuando los bloques tienen diferentes alturas."
        },
        {
          "type": "text",
          "id": "titulo_acordeon",
          "label": "Título del acordeón",
          "default": "Ver detalles"
        },
        {
          "type": "richtext",
          "id": "contenido_acordeon",
          "label": "Contenido"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Fila de contenido",
      "category": "Decoraciones",
      "blocks": []
    }
  ]
}
{% endschema %}

{% stylesheet %}
  .filaContenido {
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    padding: 1rem 0;
    width: 100%;
    position: relative;
  }

  .filaContenido--start {
    justify-content: flex-start;
  }

  .filaContenido--center {
    justify-content: center;
  }

  .filaContenido--end {
    justify-content: flex-end;
  }

  .filaContenido--space-between {
    justify-content: space-between;
  }

  .filaContenido--space-around {
    justify-content: space-around;
  }

  .filaContenido--space-evenly {
    justify-content: space-evenly;
  }

  .bloqueContenido {
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    padding: 0 1rem;
  }

  .bloqueContenido--v-arriba {
    align-self: flex-start;
    justify-content: flex-start;
  }

  .bloqueContenido--v-centro {
    align-self: center;
    justify-content: center;
  }

  .bloqueContenido--v-abajo {
    align-self: flex-end;
    justify-content: flex-end;
  }

  .bloqueContenido--izquierda {
    text-align: left;
  }

  .bloqueContenido--centro {
    text-align: center;
  }

  .bloqueContenido--derecha {
    text-align: right;
  }

  .bloqueContenido--completo {
    width: 100%;
  }

  .bloqueContenido--mitad {
    width: 50%;
  }

  .bloqueContenido--tercio {
    width: 33.333%;
  }

  .bloqueContenido--dos-tercios {
    width: 66.666%;
  }

  .bloqueContenido--cuarto {
    width: 25%;
  }

  .bloqueContenido--tres-cuartos {
    width: 75%;
  }

  .bloqueContenido--quinto {
    width: 20%;
  }

  .bloqueContenido--dos-quintos {
    width: 40%;
  }

  .bloqueContenido--tres-quintos {
    width: 60%;
  }

  .bloqueContenido--cuatro-quintos {
    width: 80%;
  }

  .contenidoTexto {
    line-height: var(--line-height, 1.5);
  }

  .contenidoTexto p {
    margin-block-end: var(--espaciado-p, 1em);
  }

  .contenidoTexto p:first-child {
    margin-block-start: 0;
  }

  .contenidoTexto--borde-arriba {
    border-top: var(--borde-grosor, 1px) solid var(--color-foreground, #111);
    padding-top: 1rem;
  }

  .contenidoTexto--borde-abajo {
    border-bottom: var(--borde-grosor, 1px) solid var(--color-foreground, #111);
    padding-bottom: 1rem;
  }

  .contenidoTexto--borde-izquierda {
    border-left: var(--borde-grosor, 1px) solid var(--color-foreground, #111);
    padding-left: 1rem;
  }

  .contenidoTexto--borde-derecha {
    border-right: var(--borde-grosor, 1px) solid var(--color-foreground, #111);
    padding-right: 1rem;
  }

  .contenidoTexto--borde-completo {
    border: var(--borde-grosor, 1px) solid var(--color-foreground, #111);
    padding: 1rem;
  }

  .enlaceTexto {
    margin-top: 1.5em;
  }

  .imagenBloque {
    width: 100%;
    height: auto;
    display: block;
  }

  .leyendaImagen {
    margin-top: 0.5rem;
    font-size: 0.85rem;
    color: rgba(0, 0, 0, 0.7);
  }

  .contenidoImagen--flotante {
    position: absolute;
    top: 2rem;
    width: 300px;
    max-width: 30%;
    z-index: 10;
  }

  .contenidoImagen--flotante-izquierda {
    left: 1rem;
  }

  .contenidoImagen--flotante-derecha {
    right: 1rem;
  }

  @media (max-width: 768px) {
    .contenidoImagen--flotante {
      position: static;
      width: 100%;
      max-width: 100%;
      margin-bottom: 1rem;
    }
  }

  @media (max-width: 768px) {
    .bloqueContenido--mitad,
    .bloqueContenido--tercio,
    .bloqueContenido--dos-tercios,
    .bloqueContenido--cuarto,
    .bloqueContenido--tres-cuartos,
    .bloqueContenido--quinto,
    .bloqueContenido--dos-quintos,
    .bloqueContenido--tres-quintos,
    .bloqueContenido--cuatro-quintos {
      width: 100%;
    }
  }

  @media (min-width: 769px) and (max-width: 1024px) {
    .bloqueContenido--tercio,
    .bloqueContenido--dos-tercios,
    .bloqueContenido--cuarto,
    .bloqueContenido--tres-cuartos,
    .bloqueContenido--quinto,
    .bloqueContenido--dos-quintos,
    .bloqueContenido--tres-quintos,
    .bloqueContenido--cuatro-quintos {
      width: 50%;
    }
  }
{% endstylesheet %}
